var __defProp=Object.defineProperty;var __defNormalProp=(obj,key,value)=>key in obj?__defProp(obj,key,{enumerable:!0,configurable:!0,writable:!0,value}):obj[key]=value;var __name=(target,value)=>__defProp(target,"name",{value,configurable:!0});var __publicField=(obj,key,value)=>(__defNormalProp(obj,typeof key!="symbol"?key+"":key,value),value),__accessCheck=(obj,member,msg)=>{if(!member.has(obj))throw TypeError("Cannot "+msg)};var __privateGet=(obj,member,getter)=>(__accessCheck(obj,member,"read from private field"),getter?getter.call(obj):member.get(obj)),__privateAdd=(obj,member,value)=>{if(member.has(obj))throw TypeError("Cannot add the same private member more than once");member instanceof WeakSet?member.add(obj):member.set(obj,value)},__privateSet=(obj,member,value,setter)=>(__accessCheck(obj,member,"write to private field"),setter?setter.call(obj,value):member.set(obj,value),value),__privateWrapper=(obj,member,setter,getter)=>({set _(value){__privateSet(obj,member,value,setter)},get _(){return __privateGet(obj,member,getter)}});__name(function(){const relList=document.createElement("link").relList;if(relList&&relList.supports&&relList.supports("modulepreload"))return;for(const link of document.querySelectorAll('link[rel="modulepreload"]'))processPreload(link);new MutationObserver(mutations=>{for(const mutation of mutations)if(mutation.type==="childList")for(const node of mutation.addedNodes)node.tagName==="LINK"&&node.rel==="modulepreload"&&processPreload(node)}).observe(document,{childList:!0,subtree:!0});function getFetchOpts(script){const fetchOpts={};return script.integrity&&(fetchOpts.integrity=script.integrity),script.referrerpolicy&&(fetchOpts.referrerPolicy=script.referrerpolicy),script.crossorigin==="use-credentials"?fetchOpts.credentials="include":script.crossorigin==="anonymous"?fetchOpts.credentials="omit":fetchOpts.credentials="same-origin",fetchOpts}__name(getFetchOpts,"getFetchOpts");function processPreload(link){if(link.ep)return;link.ep=!0;const fetchOpts=getFetchOpts(link);fetch(link.href,fetchOpts)}__name(processPreload,"processPreload")},"polyfill")();function Create(html){let template=document.createElement("template");if(template.innerHTML=html,template.content==null)throw"Create: template.content is null";return template.content}__name(Create,"Create");const hashValue=__name(function(str){let hash=0,i,chr;if(str.length===0)return hash;for(i=0;i<str.length;i++)chr=str.charCodeAt(i),hash=(hash<<5)-hash+chr,hash|=0;return hash},"hashValue"),edpAppend=__name(function(frag,elements){if(frag instanceof NodeList)return frag.forEach(nde=>edpAppend(nde,elements)),frag;if(frag instanceof DocumentFragment||frag instanceof Element){if(typeof elements=="string")edpAppend(frag,Create(elements));else if(elements instanceof NodeList){let elementsArr=Array.prototype.slice.call(elements);for(let index=0;index<elementsArr.length;index++){const element=elementsArr[index];edpAppend(frag,element)}}else if(Array.isArray(elements))for(let index=0;index<elements.length;index++){const element=elements[index];edpAppend(frag,element)}else elements instanceof Node&&frag.append(elements);return frag}},"edpAppend");var _components,_state,_pushManagerInstance,_globalIncrement;class EdApp{constructor(){__publicField(this,"rootElement",null);__privateAdd(this,_components,{});__privateAdd(this,_state,{});__privateAdd(this,_pushManagerInstance,void 0);__privateAdd(this,_globalIncrement,0);__publicField(this,"getNewIncrement",__name(()=>__privateWrapper(this,_globalIncrement)._++,"getNewIncrement"))}setApplicationRoot(rootElement){this.rootElement=rootElement}getApplicationRoot(){return this.rootElement}swapModuleInstances(newModule){for(const key in newModule)if(Object.hasOwnProperty.call(newModule,key)){const ModuleExported=newModule[key];for(const key2 in __privateGet(this,_components))if(Object.hasOwnProperty.call(__privateGet(this,_components),key2)){let component=__privateGet(this,_components)[key2];if(component.constructor.name===ModuleExported.name){console.log(`hot swapped ${component.constructor.name}`);let originalRootElement=component.rootElement;component=new ModuleExported(component.props,originalRootElement),component.render(component.props)}}}}pushManager(){return typeof __privateGet(this,_pushManagerInstance)>"u"&&__privateSet(this,_pushManagerInstance,new EdAppPushManager),__privateGet(this,_pushManagerInstance)}getComponent(ChosenClass,props,domLocation){let hash=hashValue(ChosenClass.toString()+JSON.stringify(props)+domLocation);return __privateGet(this,_components)[hash]||!1}registerComponent(ChosenClass,props,domLocation){let hash=hashValue(ChosenClass.toString()+JSON.stringify(props)+domLocation);return __privateGet(this,_components)[hash]=new ChosenClass(props),__privateGet(this,_components)[hash]}getState(key){return __privateGet(this,_state)[key]}setState(key,value){__privateGet(this,_state)[key]=value,this.pushManager().propagate(key)}}__name(EdApp,"EdApp"),_components=new WeakMap,_state=new WeakMap,_pushManagerInstance=new WeakMap,_globalIncrement=new WeakMap;class EdAppPushManager{constructor(){__publicField(this,"listeningObjects");this.listeningObjects={}}async propagate(actionTriggers=[]){typeof actionTriggers=="string"&&(actionTriggers=[actionTriggers]);for(const[key,element]of Object.entries(this.listeningObjects))for(const actionTrigger of element.actions)actionTriggers.includes(actionTrigger)&&(typeof element.callback=="function"?await element.callback(actionTrigger):delete this.listeningObjects[key])}register(element){let instance=this;function generateUniqueKey(){function makeid(length){let result="",characters="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",charactersLength=characters.length;for(let i=0;i<length;i++)result+=characters.charAt(Math.floor(Math.random()*charactersLength));return result}__name(makeid,"makeid");let uniqueKey2;do uniqueKey2=makeid(16);while(instance.listeningObjects.hasOwnProperty(uniqueKey2));return uniqueKey2}__name(generateUniqueKey,"generateUniqueKey");let uniqueKey=generateUniqueKey();return element.key=uniqueKey,instance.listeningObjects[uniqueKey]=element,uniqueKey}}__name(EdAppPushManager,"EdAppPushManager");const EdUiComponent=__name(function(chosenClass,props){let _type="EdUiComponent",_chosenClass=chosenClass,_props=props,_domPosition=null;return{getType(){return _type},getProps(){return _props},setDomPosition(domPosition){_domPosition=domPosition},Qappend(){getEdApp().getComponent(_chosenClass,_props,_domPosition).append(arguments)},init(){if(_domPosition==null)throw"_domPosition not set";if(!(_chosenClass.prototype instanceof EdUiElement))throw"instance type not recognised";let existingInstance=getEdApp().getComponent(_chosenClass,_props,_domPosition);return existingInstance||getEdApp().registerComponent(_chosenClass,_props,_domPosition)}}},"EdUiComponent");class EdUiElement{constructor(initialProps={},rootElement=document.createElement("div")){__publicField(this,"classAlias","");__publicField(this,"props",{});__publicField(this,"rootElement",null);__publicField(this,"rootShadow",null);__publicField(this,"proxyHandle",{main:this,apply:function(target,scope,args){const funcName=target.name;funcName==="render"&&(this.main.rootElement.innerHTML=""),this.main._free.instanceCheck();const results=target.bind(this.main)(...args);return funcName!=="define"&&funcName!=="render"&&funcName!=="setInitialProps"?this.main.render(this.main.props):funcName==="render"&&this.main.append(results),funcName==="render"?this.main.rootElement:results}});__publicField(this,"_free",{instanceCheck:()=>{}});this.rootElement=rootElement,this.rootElement.classList.add(this.constructor.name),this.setInitialProps(initialProps);let methods=Object.getOwnPropertyNames(Object.getPrototypeOf(this)),consIndex=methods.indexOf("constructor");consIndex>-1&&methods.splice(consIndex,1),methods.forEach(methodName=>{this[methodName]=new Proxy(this[methodName],this.proxyHandle)}),this.classAlias=`classInstance${getEdApp().getNewIncrement()}`,this.define()}setInitialProps(initialProps={}){Object.assign(this.props,initialProps)}define(){}render(props={}){}propagationRegistration(actionKeys=[],callback){getEdApp().pushManager().register({actions:actionKeys,callback})}append(){let elements=[].concat.apply([],arguments).flat(),appendElements=[];for(const key in elements)if(Object.hasOwnProperty.call(elements,key)){let element=elements[key];element.hasOwnProperty("getType")&&element.getType()==="EdUiComponent"?(element.setDomPosition(this.classAlias+key),appendElements.push(element.init().render(element.getProps()))):appendElements.push(element)}edpAppend(this.rootElement,appendElements)}}__name(EdUiElement,"EdUiElement");let edAppRootInstance=null;function createEdAppRoot(){return edAppRootInstance=new EdApp}__name(createEdAppRoot,"createEdAppRoot");function getEdApp(){return edAppRootInstance}__name(getEdApp,"getEdApp");class NavBar extends EdUiElement{define(){this.propagationRegistration(["logged_in"],async key=>{this.render()})}render(){let elem=Create(`<div class='logInButtonContainer'>EdJs<button>${getEdApp().getState("logged_in")?"Log Out":"Log In"}</button></div>`);if(elem!=null)return elem.querySelector("button").addEventListener("click",()=>getEdApp().setState("logged_in",!getEdApp().getState("logged_in"))),elem}}__name(NavBar,"NavBar");class Blurb extends EdUiElement{render(){return Create(`<h2>EdUI is a practice run at creating a modern JavaScript framework in TypeScript.</h2>
		<h3>Production features</h3>
		<ul>
		<li>Built in Application State Management</li>
		<li>Virtual DOM (Custom)</li>
		<li>State memory / dynamic rendering via prop changes</li>
		</ul>

		<h3>Development features</h3>
		<ul>
		<li>The development environment supports HMR via Vite</li>
		<li>DOM class names added automatically matching JS class name.</li>
		</ul>`)}}__name(Blurb,"Blurb");class LogInForm extends EdUiElement{render(){let elem=edpAppend(document.createElement("form"),["<h1>Log In Form</h1>","<input type='email' placeholder='Email'>","<input type='password' placeholder='Password'>","<button>Log In</button>"]);return elem.querySelector("button").addEventListener("click",event=>{event.preventDefault(),getEdApp().setState("logged_in",!0)}),[elem,EdUiComponent(Blurb)]}}__name(LogInForm,"LogInForm");class LoggedInApp extends EdUiElement{render(){let elem=Create(`<div>
            <h1>You are logged in</h1>
            <button>Log Out</button>
        </div>`);return elem.querySelector("button").addEventListener("click",()=>getEdApp().setState("logged_in",!getEdApp().getState("logged_in"))),[elem,EdUiComponent(Blurb)]}}__name(LoggedInApp,"LoggedInApp");class FooterColumnElement extends EdUiElement{render(props){return props.label}}__name(FooterColumnElement,"FooterColumnElement");class FooterColumn extends EdUiElement{render(props){return props&&props.children?props.children:"Empty"}}__name(FooterColumn,"FooterColumn");class Footer extends EdUiElement{define(){this.propagationRegistration(["logged_in"],async key=>{this.render()})}render(){return[EdUiComponent(FooterColumn,{children:[EdUiComponent(FooterColumnElement,{label:getEdApp().getState("logged_in")?"Log Out":"Log In"}),EdUiComponent(FooterColumnElement,{label:"Terms and Conditions"}),EdUiComponent(FooterColumnElement,{label:"Privacy Policy"})]}),EdUiComponent(FooterColumn),EdUiComponent(FooterColumn)]}}__name(Footer,"Footer");class App extends EdUiElement{define(){this.propagationRegistration(["logged_in"],async key=>{this.render()})}render(){return[EdUiComponent(NavBar),EdUiComponent(getEdApp().getState("logged_in")?LoggedInApp:LogInForm),EdUiComponent(Footer)]}}__name(App,"App");createEdAppRoot().setApplicationRoot(document.querySelector(".wrapper"));edpAppend(document.querySelector(".wrapper"),new App().render());
